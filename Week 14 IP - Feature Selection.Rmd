---
title: "Week 14 IP - Feature Selection"
author: "Billiah"
date: '2022-04-01'
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Libraries}
library (caret)
library(corrplot)
library(clustvarsel)
library(mclust)
library(wskm)
library("cluster")


```

```{r Loading and previewing data}
path<-"http://bit.ly/CarreFourDataset"
data <- read.csv(path)
head(data)
```

```{r Size of the dataset}
dim(data)
```
The dataset has 1000 rows and 16 columns.

```{r Structure}
str(data)
```

```{r Checking for missing values}
sum(is.na(data))

```
There are no null values.

```{r Checking for duplicates}
sum(duplicated(data))

```
There are no duplicates in the dataset.

```{r Filter Methods}
# Getting numeric columns
n_data <- data[c(6:8,12,14:16)]
# Finding correlation matrix
corr_m <- cor(n_data)
# Features that are highly correlated
h_corr <- findCorrelation(corr_m, cutoff=0.75)
names(n_data[,h_corr])
# Removing variables with high correlation
data_1<-n_data[-h_corr]
# Graphical comparison
par(mfrow = c(1, 2))
corrplot(corr_m, order = "hclust")
corrplot(cor(data_1), order = "hclust")


```
The highly correlated features(Tax and cogs) have been eliminated.

```{r Wrapper Methods}
# Sequential search
data_2 = clustvarsel(n_data, G = 1:5)
data_2

```
Gross income has been accepted, as well as tax. These are the optimal variables in this

dataset.
```{r}
Subset1 = n_data[,data_2$subset]
mod = Mclust(Subset1, G = 1:5)
summary(mod)

```

```{r}
# PLotting
plot(mod,c("classification"))

```
The optimal features are gross income and tax, which have a linear correlation. An 

increase in gross income influences an increase in tax.


```{r Embedded Methods}
# The ewkm function from the wskm package will be used.
# This is a weighted subspace clustering algorithm that is well suited to very high dimensional data
set.seed(2)
model <- ewkm(n_data,3, lambda=2, maxiter=1000)
```

```{r}
#  Cluster Plot against 1st 2 principal components
clusplot(n_data, model$cluster, color=TRUE, shade=TRUE,
         labels=2, lines=1,main='Cluster Analysis for Total Prices')
```
The two components cumulatively explain 84.6% variability in the data. Therefore, the two

components capture alot of information in the data.

To measure importanc of each element, weight have to be calculated, incorporated in the

distance function.

```{r}
# Checking for weights
round(model$weights*100,2)
```

Tax has more weight in cluster 1 and 3, gross income has more weight in cluster 1 and 3.

Rating has more weight in the second cluster.


CONCLUSION

Gross income plays an important role in the total value of items. It is an important 

variable in this dataset.

To increase the total prices, the gross income has to be evaluated first.



